# 数字白板应用需求文档

## 1. 项目概述

### 1.1 项目名称

wl-draw - 数字白板绘图应用

### 1.2 项目目标

开发一个功能完善的数字白板应用，支持多种绘图工具、文本编辑、画布操作等功能，为用户提供流畅的绘图和编辑体验。

### 1.3 核心价值

- 提供直观、简洁的绘图界面
- 支持多种图形绘制工具
- 支持文本编辑和图片插入
- 提供完整的画布操作和视图控制
- 支持操作历史记录（撤销/重做）

## 2. 功能需求

### 2.1 绘图工具

#### 2.1.1 选择工具

- **功能描述**：用于选择、移动和调整画布上的对象
- **交互方式**：鼠标点击对象进行选择，拖拽移动位置，拖拽控制点调整大小
- **视觉反馈**：选中对象时显示选择框和控制点

#### 2.1.2 平移工具（抓手工具）

- **功能描述**：用于移动画布视图，不改变对象位置
- **交互方式**：鼠标按下拖拽移动画布
- **图标**：手掌图标

#### 2.1.3 矩形工具

- **功能描述**：绘制矩形和正方形
- **交互方式**：鼠标按下拖拽绘制矩形，按住 Shift 键绘制正方形
- **样式**：支持填充颜色和边框颜色设置
- **图标**：空心正方形图标

#### 2.1.4 圆形工具

- **功能描述**：绘制圆形和椭圆
- **交互方式**：鼠标按下拖拽绘制椭圆，按住 Shift 键绘制正圆
- **样式**：支持填充颜色和边框颜色设置
- **图标**：空心圆形图标

#### 2.1.5 直线工具

- **功能描述**：绘制直线段
- **交互方式**：鼠标按下拖拽绘制直线，按住 Shift 键绘制水平/垂直/45 度角直线
- **样式**：支持线条颜色、粗细、样式（实线/虚线）设置
- **图标**：短横线图标

#### 2.1.6 箭头工具

- **功能描述**：绘制带箭头的直线
- **交互方式**：鼠标按下拖拽绘制箭头，箭头指向拖拽结束位置
- **样式**：支持线条颜色、粗细设置，支持箭头样式和大小设置
- **图标**：带箭头的直线图标

#### 2.1.7 自由绘制工具（画笔）

- **功能描述**：自由绘制曲线和手写
- **交互方式**：鼠标按下移动自由绘制
- **样式**：支持画笔颜色、粗细设置，支持平滑度设置
- **图标**：画笔/铅笔图标

### 2.2 文本工具

#### 2.2.1 文本添加

- **功能描述**：在画布上添加文本
- **交互方式**：点击文本工具后在画布上点击位置添加文本框，进入编辑模式
- **图标**：大写字母 "A" 图标

#### 2.2.2 文本编辑

- **功能**：支持文本内容的编辑、删除
- **样式设置**：
  - 字号：支持字号大小设置
  - 颜色：支持文本颜色设置
  - 样式：支持粗体、斜体、下划线等样式
  - 对齐：支持左对齐、居中、右对齐（如果支持多行）

#### 2.2.3 文本移动

- **功能**：支持文本对象的移动和位置调整

### 2.3 图片插入

#### 2.3.1 插入图片

- **功能描述**：在画布上插入图片
- **交互方式**：点击图片图标，选择本地图片文件或输入图片 URL
- **支持格式**：JPG、PNG、GIF、SVG 等常见图片格式
- **图标**：图片图标

#### 2.3.2 图片操作

- **功能**：支持图片的移动、缩放、旋转、删除
- **约束**：保持图片宽高比

### 2.4 画布操作

#### 2.4.1 缩放功能

- **功能描述**：放大和缩小画布视图
- **操作方式**：
  - 点击加号图标放大
  - 点击减号图标缩小
  - 支持鼠标滚轮缩放
  - 支持快捷键缩放（Ctrl/Cmd + 滚轮）
- **显示**：显示当前缩放比例（如 "100%"）
- **缩放范围**：建议 10% ~ 500%

#### 2.4.2 平移功能

- **功能描述**：通过抓手工具平移画布视图
- **操作方式**：使用平移工具或按住空格键+鼠标拖拽

#### 2.4.3 画布属性

- **画布尺寸**：无限画布、无限滚动
- **画布背景**：白色

### 2.5 历史记录

#### 2.5.1 撤销操作

- **功能描述**：撤销上一步操作
- **操作方式**：点击撤销图标或使用快捷键（Ctrl/Cmd + Z）
- **图标**：左向箭头图标
- **限制**：支持多步撤销，建议至少支持 50 步历史记录

#### 2.5.2 重做操作

- **功能描述**：恢复被撤销的操作
- **操作方式**：点击重做图标或使用快捷键（Ctrl/Cmd + Shift + Z）
- **图标**：右向箭头图标

## 3. UI/UX 需求

### 3.1 界面布局

#### 3.1.1 顶部工具栏

- **位置**：画布上方
- **内容**：包含所有绘图工具和操作工具
- **样式**：
  - 工具图标清晰可识别
  - 当前选中工具高亮显示
  - 支持工具提示（Tooltip）
  - 图标间距适中，易于点击

#### 3.1.2 底部工具栏

- **位置**：画布下方
- **内容**：视图控制（缩放）和历史操作（撤销/重做）
- **样式**：
  - 显示当前缩放比例
  - 图标清晰可识别

#### 3.1.3 中央画布区域

- **位置**：最底部
- **样式**：
  - 默认背景为白色
  - 支持无限画布
  - 支持无限滚动

### 3.2 交互体验

#### 3.2.1 工具切换

- 点击工具栏图标切换工具
- 当前选中工具视觉反馈明显（高亮/激活状态）

#### 3.2.2 绘制反馈

- 绘制过程中实时预览
- 绘制完成后的对象可立即编辑

#### 3.2.3 选择反馈

- 选中对象时显示选择框
- 选择框四角和边缘中点显示控制点（用于调整大小）
- 鼠标悬停时显示操作提示

### 3.3 颜色选择

#### 3.3.1 颜色选择器

- 需要提供颜色选择器用于设置：
  - 填充颜色（矩形、圆形）
  - 线条颜色（直线、箭头、画笔）
  - 文本颜色

## 4. 技术需求

### 4.1 技术栈

- **框架**：Vue 3（已确认）
- **语言**：TypeScript（已确认）
- **构建工具**：Vite（已确认）
- **UI 组件库**：Naive UI（已集成，支持自动按需导入）
- **状态管理**：Pinia（已集成）
- **CSS 框架**：Tailwind CSS v4（已集成，使用 @tailwindcss/vite 插件）
- **图标库**：Iconify（已集成，使用 unplugin-icons 支持自动导入，200,000+ 图标）
- **绘图引擎**：Leafer（已集成，包含 leafer 核心库和 leafer-draw 绘图库）
- **快捷键支持**：VueUse（已集成，用于键盘事件处理和快捷键绑定）

### 4.2 核心技术点

#### 4.2.1 绘图引擎

- **已确定**：使用 Leafer 作为绘图引擎（已集成）
  - **核心库**：`leafer` - 提供基础画布和渲染能力
  - **绘图库**：`leafer-draw` - 提供绘图工具和功能扩展
  - **特性**：
    - 高性能 Canvas 渲染引擎
    - 支持多种图形元素（矩形、圆形、直线、曲线等）
    - 支持对象拖拽、缩放、旋转
    - 支持无限画布和视图操作
    - 良好的 TypeScript 类型支持

#### 4.2.2 状态管理

- 需要管理画布上的所有对象（图形、文本、图片）
- 需要管理操作历史记录（用于撤销/重做）
- **已确定**：使用 Pinia 进行状态管理（已集成）

#### 4.2.3 事件处理

- **鼠标事件**：click、mousedown、mousemove、mouseup
  - 由 Leafer 引擎提供原生事件支持
  - 支持对象选择、拖拽、缩放等交互操作
- **键盘事件**：快捷键支持
  - **已确定**：使用 VueUse 处理键盘快捷键（已集成）
  - 支持组合键（如 Ctrl/Cmd + Z、Ctrl/Cmd + S）
  - 支持按键状态检测
  - 提供响应式的快捷键管理能力

#### 4.2.4 数据持久化

- 支持导出画布内容（PNG、SVG、JSON 格式）
- 支持导入画布内容（JSON 格式）
- 可选：本地存储（LocalStorage）自动保存

### 4.3 性能要求

- 流畅的绘制体验（60fps）
- 支持至少 100 个对象同时存在
- 快速响应用户操作（延迟 < 100ms）

### 4.4 开发工具和配置

#### 4.4.1 自动导入配置

- **unplugin-auto-import**：自动导入 Vue、Naive UI、Pinia 的 API

  - Vue: `ref`, `computed`, `watch` 等
  - Naive UI: `useDialog`, `useMessage`, `useNotification`, `useLoadingBar`
  - Pinia: `defineStore`, `storeToRefs`

- **unplugin-vue-components**：自动导入组件
  - Naive UI 组件自动导入
  - Iconify 图标组件自动导入（前缀：`i-{图标集}:{图标名}`）

#### 4.4.2 样式配置

- **Tailwind CSS v4**：使用 Vite 插件方式集成
  - CSS 语法：`@import "tailwindcss"`
  - 零配置，自动扫描项目文件
  - 支持响应式设计和工具类

#### 4.4.3 代码规范

- **ESLint**：代码质量检查
- **Stylelint**：样式代码检查
- **Prettier**：代码格式化
- **TypeScript**：严格模式，完整类型检查

### 4.5 兼容性要求

- 现代浏览器支持（Chrome、Firefox、Safari、Edge 最新版本）

---

**文档版本**：v1.2  
**创建日期**：2024  
**最后更新**：2024-12-19

### 更新日志

#### v1.2 (2024-12-19)

- 更新技术需求部分：
  - 确定并使用 Leafer 作为绘图引擎（包含 leafer 和 leafer-draw）
  - 集成 VueUse 用于快捷键支持
  - 更新绘图引擎和事件处理的详细说明

#### v1.1 (2024-12-19)

- 更新技术栈部分，记录已集成技术：
  - Naive UI 组件库集成
  - Pinia 状态管理集成
  - Tailwind CSS v4 集成
  - Iconify 图标库集成
