# 通用代码质量三维度标准

**核心哲学**：代码是写给人看的，顺便给机器执行。质量判断始终围绕"六个月后的我能否轻松理解并安全修改这段代码"展开。

### 一、可理解性与清晰性（Comprehensibility & Clarity）

代码首先是给人阅读的，清晰胜于简洁。

**命名与表达**
优秀的命名应当自解释，无需注释即可理解用途。例如使用 `calculateWeightedAverage` 而非模糊的 `calc` 或 `temp`。警惕拼音缩写、无意义命名（如 `aaa`, `handler2`）以及语义与实现不符的名称。选择**显式代码**而非过于紧凑的表达式，避免嵌套三元运算符（优先使用 switch 或 if/else 链），绝不为减少行数而牺牲可读性。

**复杂度控制**
单一函数应当职责单一，圈复杂度控制在 10 以内，嵌套层级不超过 3 层。通过合并相关逻辑、消除冗余代码和抽象来降低复杂性。避免出现巨型函数（超过 50 行）、深层嵌套（超过 4 层逻辑分支）以及大量条件分支堆砌而成的"箭头代码"。

**代码纯净**
移除描述显而易见代码的不必要注释——代码应当自成文档。逻辑分组应当清晰，相关功能在物理位置上彼此接近，文件与模块粒度适中（单文件控制在 500 行以内）。避免万能类（God Object）、循环依赖、以及过度碎片化。

---

### 二、可维护性（Maintainability）

代码应对变化保持开放，同时遵循既定契约。

**开闭原则**
新功能应当通过扩展而非修改现有代码来实现。如果每新增一个需求都需要修改 5 处以上的现有文件，产生大量连锁反应，则说明扩展性存在严重问题。

**重复度控制**
遵循 DRY（Don't Repeat Yourself）原则，将相似逻辑抽象为可复用单元。但允许战略性重复（如边界上下文之间）。警惕简单的复制粘贴（同一逻辑出现 3 处以上）、仅变量名不同的重复逻辑块。

**依赖管理**
依赖关系应当单向无环，抽象不应依赖具体实现，第三方库必须隔离封装。避免循环导入、在业务代码中直接实例化具体类、以及让框架代码渗透到业务核心层。

**适度抽象**
遵循 DRY 原则消除重复（超过 3 处的相似逻辑必须抽象），但警惕**过度简化**。保留那些虽增加间接层但能改善代码组织的有价值抽象。避免将过多关注点压缩到单一函数或组件中，不创建过于"聪明"而难以理解的解法。配置与代码必须分离，环境相关值（密钥、URL、阈值）绝不可硬编码。

---

### 三、健壮性与精准性（Robustness & Precision）

代码在恶劣环境下保持正确。

**错误处理**
错误处理路径应当与主逻辑分离，异常对象必须携带足够的上下文信息，遵循失败快速（Fail Fast）原则。严禁使用空的 catch 块吞掉异常、用返回 null 来表示错误、或在 HTTP 200 状态码中包装业务错误等混淆行为。

---

**评估原则**：这三个维度构成代码质量的"铁三角"——**可理解性**是维护的前提，**可维护性**是演化的基础，**健壮性**是可靠性的保障。
